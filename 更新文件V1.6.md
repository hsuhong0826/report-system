# 系統更新說明文件V1.6

## 1. 客戶端報修系統更新
所有客戶端程式 (`揚發.py`, `萬陽.py`, `立侑螺絲.py`, `金總源.py`) 皆已同步至最新版本，主要更新內容如下：
- **截圖功能升級**: 導入 `mss` 套件，支援多螢幕截圖，解決舊版單螢幕截圖限制。
- **自動編號**: 新增報修單 ID 自動生成功能 (格式：`[前綴]YYYYMMDD-XXX`)。
- **資料庫寫入**: 支援將 ID 寫入 NAS Excel。
- **密碼驗證**: 除揚發外，其餘公司保留密碼驗證機制。

### 各公司設定差異
| 公司 | 檔案名稱 | ID 前綴 | 密碼 | FTP IP | 備註 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **揚發** | `揚發.py` | `R` | (無) | 192.168.0.215 | 含辦公室欄位 |
| **萬陽** | `萬陽.py` | `W` | 80505185 | 192.168.1.240 | |
| **立侑螺絲** | `立侑螺絲.py` | `L` | 22239029 | 192.168.1.253 | |
| **金總源** | `金總源.py` | `C` | 16262599 | 192.168.1.253 | |

## 2. 工程師回報系統 (總report.py)
- **整合介面**: 單一程式即可管理所有公司的報修單。
- **公司切換**: 下拉選單選擇公司後，自動切換對應的 FTP、Email 設定與 ID 前綴。
- **功能**:
  - 搜尋報修單 (自動帶入對應前綴)。
  - 檢視問題描述。
  - 填寫處理方式。
  - 更新 NAS 資料庫並寄送 Email 通知客戶。

## 3. 資料庫遷移工具 (Update Scripts)
為配合新系統，需執行以下腳本以升級 NAS 上的 Excel 結構：
- `萬陽update.py`: 針對萬陽，ID 前綴 `W`。
- `立侑螺絲update.py`: 針對立侑螺絲，ID 前綴 `L`。
- `金總源update.py`: 針對金總源，ID 前綴 `C`。

**執行動作**:
1. 自動備份原始 Excel (檔名加上時間戳記)。
2. 新增 `ID` 欄位 (位於第一欄)，並為舊資料自動補號。
3. 新增 `處理方式` 與 `處理時間` 欄位。
